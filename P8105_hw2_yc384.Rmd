---
title: "P8105_hw2_yc384"
author: 'Ying Chen (UNI: yc384)'
date: "9/24/2019"
output: github_document
---

setwd("/Users/macbook/Documents/Statistics/P8105/HW/P8105 HW2")

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
library (tidyverse)
library (dplyr)
library(readxl)
rm(list = ls())

options(tibble.print_min = 3)
```

##  P8105 DSI Homework 1
### This assignment reinforces ideas in Data Wrangling I

####  1. Problem 0 
      * Github repo: https://github.com/YingCarolineChen/p8105_hw2_yc384.git
      * RMarkdown file name: P8105_hw2_yc384
      * Create a subdirectory to store local data files and the path is:
        "~/Documents/Statistics/P8105/HW/P8105 HW2"

###   2. Problem 1 
      * 1-1 Read and tidy Mr. Trash Wheel data
      * Dataset: Mr. Trash Wheel / MS Excel file / Contains 8 sheets

```{r Q1MrTrashWheel}
# read in Mr. Trash Wheel sheet
# skip first rows with notes / figures
# drop last column that containing notes
MrTrashWheel = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "Mr. Trash Wheel", skip = 1, range = "A2:N338", col_names = TRUE) %>% 
  janitor::clean_names()

# omit rows has NA for dumpster
dumpster = 
  drop_na(MrTrashWheel,dumpster) %>% 
  # Round sports balls to nearest integer
  mutate(
  sports_balls_round = round(sports_balls, digits = 0),
  sports_balls_int = as.integer(sports_balls_round)
)

# rename to reasonable variable names
dumpster_rename = rename(dumpster, bags_grocery = grocery_bags, bags_chip  = chip_bags, bottles_plastic = plastic_bottles, bottles_glass = glass_bottles)

# Check data
head(MrTrashWheel,5)
head(dumpster_rename, 5)
```

###   2. Problem 1 
      * 1-2 Read and tidy precipitation data
      *     join datasets and some data manipulations

```{r Q1Precipitation}
# read in precipitation data for 2017 and 2018
# Omit rows without precipitation data and add a variable year
precipitation_2017 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2017 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2017) %>% 
  drop_na (total)

precipitation_2018 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2018 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2018) %>% 
  drop_na (total)

# Combine precipitation datasets
precipitation_join = 
  full_join(precipitation_2017, precipitation_2018, by = NULL) %>% 
  # convert month to a character variable
  mutate(
    month = month.name[month]
  )

head(precipitation_join,5)
```

###   2. Problem 1 
####      * 1-3 Datasets description using inline R code 

```{r dump2017}
dump2017 = filter(dumpster, year == 2017)
```

Dataset Mr. Trash Wheel contains `r nrow(MrTrashWheel)` obersvations and `r ncol(MrTrashWheel)` variables. The key variable for this dataset is called "dumpster". Variable "dumpster" has `r (nrow(MrTrashWheel) - nrow(dumpster))` rows with "NA" and will be excluded for future analyses. The median number of sports balls in a dumpster in 2017 is: `r median(dump2017$sports_balls)`.

Dataset precipitation_2017 contains `r nrow(precipitation_2017)` obersvations and `r ncol(precipitation_2017)` variables. The key variables for this dataset is year and month. Dataset precipitation_2018 contains `r nrow(precipitation_2018)` obersvations and `r ncol(precipitation_2018)` variables. The key variables for this dataset are year and month. Dataset precipitation_join is the combination of datasets precipitation_2017 and precipitation_2018. The total precipitation is 2018 is `r sum(precipitation_2018$total)`in.


###   3. Problem 2 
####      * Read pols-month.csv, unemployment.csv, and snp.csv and merge them using year and month as keys

####      * 2-1 This code cunk will read and tidy pols-month.csv. 
####      *     break up the variable mon into integer variables year, month, and day; 
####      *     replace month number with month name; 
####      *     create a president variable taking values gop and dem, remove prez_dem, prez_gop and the day variable.

```{r Q2 pols}
# read in pols-month.csv
pols_tidy = 
  read_csv("./data/pols-month.csv", col_names = TRUE) %>% 
  mutate (
    # change date format
    Date = as.Date(mon, format='%m/%d/%Y')
  ) %>% 
  janitor::clean_names() %>% 
  # break date to three vars
  separate(., "date", c("year", "month", "day")) %>% 
  mutate (
   month = as.numeric(month),
   #replace month number with month name
   month = month.name[c(month)],
   president = prez_gop + prez_dem
  ) %>% 
  # reorder varaibles and remove three variables
  select(year, month, everything(), -prez_dem, -prez_gop, -day)
```


```{r Q2 snp}
# read in snp.csv
snp_tidy = 
  read_csv("./data/snp.csv", col_names = TRUE) %>% 
  mutate (
    # change date format
    Date1 = as.Date(date, format='%m/%d/%Y')
  ) %>% 
  janitor::clean_names() %>% 
  # break date to three vars
  separate(., "date1", c("year", "month", "day")) %>% 
  mutate (
   month = as.numeric(month),
   #replace month number with month name
   month = month.name[c(month)],
  ) %>% 
  # reorder varaibles and remove three variables
  select(year, month, everything(), -day)
```


```{r Q2 unemployment}
# read in unemployment.csv
unemployment = 
  read_csv("./data/unemployment.csv", col_names = TRUE) %>% 
  janitor::clean_names()
unemployment

unemployment_tidy = 
  pivot_longer(
    unemployment,
    jan:dec,
    names_to = "month",
    values_to = "unemploy_rate"
  )

unemployment_tidy
```

























