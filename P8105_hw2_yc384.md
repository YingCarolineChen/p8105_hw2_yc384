P8105\_hw2\_yc384
================
Ying Chen (UNI: yc384)
9/24/2019

setwd(“/Users/macbook/Documents/Statistics/P8105/HW/P8105 HW2”)

``` r
knitr::opts_chunk$set(echo = TRUE)
library (tidyverse)
```

    ## -- Attaching packages ---------------------------------------------------------------------------------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.2.1     v purrr   0.3.2
    ## v tibble  2.1.3     v dplyr   0.8.3
    ## v tidyr   1.0.0     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.4.0

    ## -- Conflicts ------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library (dplyr)
library(readxl)
rm(list = ls())

options(tibble.print_min = 3)
```

## P8105 DSI Homework 1

### This assignment reinforces ideas in Data Wrangling I

#### 1\. Problem 0

``` 
  * Github repo: https://github.com/YingCarolineChen/p8105_hw2_yc384.git
  * RMarkdown file name: P8105_hw2_yc384
  * Create a subdirectory to store local data files and the path is:
    "~/Documents/Statistics/P8105/HW/P8105 HW2"
```

### 2\. Problem 1

``` 
  * 1-1 Read and tidy Mr. Trash Wheel data
  * Dataset: Mr. Trash Wheel / MS Excel file / Contains 8 sheets
```

``` r
# read in Mr. Trash Wheel sheet
# skip first rows with notes / figures
# drop last column that containing notes
MrTrashWheel = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "Mr. Trash Wheel", skip = 1, range = "A2:N338", col_names = TRUE) %>% 
  janitor::clean_names()

# omit rows has NA for dumpster
dumpster = 
  drop_na(MrTrashWheel,dumpster) %>% 
  # Round sports balls to nearest integer
  mutate(
  sports_balls_round = round(sports_balls, digits = 0),
  sports_balls_int = as.integer(sports_balls_round)
)

# rename to reasonable variable names
dumpster_rename = rename(dumpster, bags_grocery = grocery_bags, bags_chip  = chip_bags, bottles_plastic = plastic_bottles, bottles_glass = glass_bottles)

# Check data
head(MrTrashWheel,5)
```

    ## # A tibble: 5 x 14
    ##   dumpster month  year date                weight_tons volume_cubic_ya~
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## # ... with 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, grocery_bags <dbl>,
    ## #   chip_bags <dbl>, sports_balls <dbl>, homes_powered <dbl>

``` r
head(dumpster_rename, 5)
```

    ## # A tibble: 5 x 16
    ##   dumpster month  year date                weight_tons volume_cubic_ya~
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## # ... with 10 more variables: bottles_plastic <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, bottles_glass <dbl>, bags_grocery <dbl>,
    ## #   bags_chip <dbl>, sports_balls <dbl>, homes_powered <dbl>,
    ## #   sports_balls_round <dbl>, sports_balls_int <int>

### 2\. Problem 1

``` 
  * 1-2 Read and tidy precipitation data
  *     join datasets and some data manipulations
```

``` r
# read in precipitation data for 2017 and 2018
# Omit rows without precipitation data and add a variable year
precipitation_2017 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2017 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2017) %>% 
  drop_na (total)

precipitation_2018 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2018 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>% 
  janitor::clean_names() %>% 
  mutate(
    year = 2018) %>% 
  drop_na (total)

# Combine precipitation datasets
precipitation_join = 
  full_join(precipitation_2017, precipitation_2018, by = NULL) %>% 
  # convert month to a character variable
  mutate(
    month = month.name[month]
  )
```

    ## Joining, by = c("month", "total", "year")

``` r
head(precipitation_join,5)
```

    ## # A tibble: 5 x 3
    ##   month    total  year
    ##   <chr>    <dbl> <dbl>
    ## 1 January   2.34  2017
    ## 2 February  1.46  2017
    ## 3 March     3.57  2017
    ## 4 April     3.99  2017
    ## 5 May       5.64  2017

### 2\. Problem 1

#### \* 1-3 Datasets description using inline R code

``` r
dump2017 = filter(dumpster, year == 2017)
```

Dataset Mr. Trash Wheel contains 336 obersvations and 14 variables. The
key variable for this dataset is called “dumpster”. Variable “dumpster”
has 51 rows with “NA” and will be excluded for future analyses. The
median number of sports balls in a dumpster in 2017 is: 8.

Dataset precipitation\_2017 contains 12 obersvations and 3 variables.
The key variables for this dataset is year and month. Dataset
precipitation\_2018 contains 7 obersvations and 3 variables. The key
variables for this dataset are year and month. Dataset
precipitation\_join is the combination of datasets precipitation\_2017
and precipitation\_2018. The total precipitation is 2018 is
23.5in.

### 3\. Problem 2

#### \* Read pols-month.csv, unemployment.csv, and snp.csv and merge them using year and month as keys

#### \* 2-1 This code cunk will read and tidy pols-month.csv.

#### \* break up the variable mon into integer variables year, month, and day;

#### \* replace month number with month name;

#### \* create a president variable taking values gop and dem, remove prez\_dem, prez\_gop and the day variable.

``` r
# read in pols-month.csv
pols_tidy = 
  read_csv("./data/pols-month.csv", col_names = TRUE) %>% 
  mutate (
    # change date format
    Date = as.Date(mon, format='%m/%d/%Y')
  ) %>% 
  janitor::clean_names() %>% 
  # break date to three vars
  separate(., "date", c("year", "month", "day")) %>% 
  mutate (
   month = as.numeric(month),
   #replace month number with month name
   month = month.name[c(month)],
   president = prez_gop + prez_dem
  ) %>% 
  # reorder varaibles and remove three variables
  select(year, month, everything(), -prez_dem, -prez_gop, -day)
```

    ## Parsed with column specification:
    ## cols(
    ##   mon = col_date(format = ""),
    ##   prez_gop = col_double(),
    ##   gov_gop = col_double(),
    ##   sen_gop = col_double(),
    ##   rep_gop = col_double(),
    ##   prez_dem = col_double(),
    ##   gov_dem = col_double(),
    ##   sen_dem = col_double(),
    ##   rep_dem = col_double()
    ## )

``` r
# read in snp.csv
snp_tidy = 
  read_csv("./data/snp.csv", col_names = TRUE) %>% 
  mutate (
    # change date format
    Date1 = as.Date(date, format='%m/%d/%Y')
  ) %>% 
  janitor::clean_names() %>% 
  # break date to three vars
  separate(., "date1", c("year", "month", "day")) %>% 
  mutate (
   month = as.numeric(month),
   #replace month number with month name
   month = month.name[c(month)],
  ) %>% 
  # reorder varaibles and remove three variables
  select(year, month, everything(), -day)
```

    ## Parsed with column specification:
    ## cols(
    ##   date = col_character(),
    ##   close = col_double()
    ## )

``` r
# read in unemployment.csv
unemployment = 
  read_csv("./data/unemployment.csv", col_names = TRUE) %>% 
  janitor::clean_names()
```

    ## Parsed with column specification:
    ## cols(
    ##   Year = col_double(),
    ##   Jan = col_double(),
    ##   Feb = col_double(),
    ##   Mar = col_double(),
    ##   Apr = col_double(),
    ##   May = col_double(),
    ##   Jun = col_double(),
    ##   Jul = col_double(),
    ##   Aug = col_double(),
    ##   Sep = col_double(),
    ##   Oct = col_double(),
    ##   Nov = col_double(),
    ##   Dec = col_double()
    ## )

``` r
unemployment
```

    ## # A tibble: 68 x 13
    ##    year   jan   feb   mar   apr   may   jun   jul   aug   sep   oct   nov
    ##   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1  1948   3.4   3.8   4     3.9   3.5   3.6   3.6   3.9   3.8   3.7   3.8
    ## 2  1949   4.3   4.7   5     5.3   6.1   6.2   6.7   6.8   6.6   7.9   6.4
    ## 3  1950   6.5   6.4   6.3   5.8   5.5   5.4   5     4.5   4.4   4.2   4.2
    ## # ... with 65 more rows, and 1 more variable: dec <dbl>

``` r
unemployment_tidy = 
  pivot_longer(
    unemployment,
    jan:dec,
    names_to = "month",
    values_to = "unemploy_rate"
  )

unemployment_tidy
```

    ## # A tibble: 816 x 3
    ##    year month unemploy_rate
    ##   <dbl> <chr>         <dbl>
    ## 1  1948 jan             3.4
    ## 2  1948 feb             3.8
    ## 3  1948 mar             4  
    ## # ... with 813 more rows
