P8105\_hw2\_yc384
================
Ying Chen (UNI: yc384)
9/24/2019

setwd(“/Users/macbook/Documents/Statistics/P8105/HW/P8105 HW2”)

``` r
knitr::opts_chunk$set(echo = TRUE)
library (tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.2.1     ✔ purrr   0.3.2
    ## ✔ tibble  2.1.3     ✔ dplyr   0.8.3
    ## ✔ tidyr   1.0.0     ✔ stringr 1.4.0
    ## ✔ readr   1.3.1     ✔ forcats 0.4.0

    ## ── Conflicts ────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library (dplyr)
library(readxl)
rm(list = ls())

options(tibble.print_min = 3)
```

## P8105 DSI Homework 1

### This assignment reinforces ideas in Data Wrangling I

#### 1\. Problem 0

  - Github repo:
    <https://github.com/YingCarolineChen/p8105_hw2_yc384.git>
  - RMarkdown file name: P8105\_hw2\_yc384
  - Create a subdirectory to store local data files and the path is:
    “~/Documents/Statistics/P8105/HW/P8105 HW2”

#### 2\. Problem 1

  - 1-1 Read and tidy Mr. Trash Wheel data
  - Dataset: Mr. Trash Wheel / MS Excel file / Contains 8 sheets

<!-- end list -->

``` r
# read in Mr. Trash Wheel sheet
# skip first rows with notes / figures
# drop last column that containing notes

MrTrashWheel = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "Mr. Trash Wheel", skip = 1, range = "A2:N338", col_names = TRUE) %>% 
  janitor::clean_names()

# omit rows has NA for dumpster
dumpster = 
  drop_na(MrTrashWheel,dumpster) %>% 
  # Round sports balls to nearest integer
  mutate(
  sports_balls_round = round(sports_balls, digits = 0),
  sports_balls_int = as.integer(sports_balls_round)
)

# rename to reasonable variable names
dumpster_rename = rename(dumpster, bags_grocery = grocery_bags, bags_chip  = chip_bags, bottles_plastic = plastic_bottles, bottles_glass = glass_bottles)

# Check data
head(MrTrashWheel,5)
```

    ## # A tibble: 5 x 14
    ##   dumpster month  year date                weight_tons volume_cubic_ya…
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## # … with 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, grocery_bags <dbl>,
    ## #   chip_bags <dbl>, sports_balls <dbl>, homes_powered <dbl>

``` r
head(dumpster_rename, 5)
```

    ## # A tibble: 5 x 16
    ##   dumpster month  year date                weight_tons volume_cubic_ya…
    ##      <dbl> <chr> <dbl> <dttm>                    <dbl>            <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31               18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74               13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45               15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06               18
    ## # … with 10 more variables: bottles_plastic <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, bottles_glass <dbl>, bags_grocery <dbl>,
    ## #   bags_chip <dbl>, sports_balls <dbl>, homes_powered <dbl>,
    ## #   sports_balls_round <dbl>, sports_balls_int <int>

#### 2\. Problem 1

  - 1-2 Read and tidy precipitation data

  - ``` 
    join datasets and some data manipulations
    ```

<!-- end list -->

``` r
# read in precipitation data for 2017 and 2018
# Omit rows without precipitation data and add a variable year

precipitation_2017 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2017 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>%
  janitor::clean_names() %>% 
  mutate(
    year = 2017) %>% 
  drop_na (total)

precipitation_2018 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2018 Precipitation", skip = 1, range = "A2:B14", col_names = TRUE) %>%
  janitor::clean_names() %>% 
  mutate(
    year = 2018) %>% 
  drop_na (total)

# Combine precipitation datasets
precipitation_join = 
  full_join(precipitation_2017, precipitation_2018, by = NULL) %>% 
  # convert month to a character variable
  mutate(
    month = month.name[month]
  )
```

    ## Joining, by = c("month", "total", "year")

``` r
head(precipitation_join,5)
```

    ## # A tibble: 5 x 3
    ##   month    total  year
    ##   <chr>    <dbl> <dbl>
    ## 1 January   2.34  2017
    ## 2 February  1.46  2017
    ## 3 March     3.57  2017
    ## 4 April     3.99  2017
    ## 5 May       5.64  2017

#### 2\. Problem 1

  - 1-3 Datasets description using inline R code

<!-- end list -->

``` r
# sub dataset of year 2017
dump2017 = filter(dumpster, year == 2017)
```

Dataset Mr. Trash Wheel contains 336 obersvations and 14 variables. The
key variable for this dataset is called “dumpster”. Variable “dumpster”
has 51 rows with “NA” and will be excluded for future analyses. The
median number of sports balls in a dumpster in 2017 is: 8.

Dataset precipitation\_2017 contains 12 obersvations and 3 variables.
The key variables for this dataset is year and month. Dataset
precipitation\_2018 contains 7 obersvations and 3 variables. The key
variables for this dataset are year and month. Dataset
precipitation\_join is the combination of datasets precipitation\_2017
and precipitation\_2018. The total precipitation is 2018 is 23.5in.

#### 3\. Problem 2

  - Read pols-month.csv, unemployment.csv, and snp.csv and merge them
    using year and month as keys
  - 2-1 This code cunk will read and tidy pols-month.csv.
  - break up the variable mon into integer variables year, month, and
    day;
  - replace month number with month name;
  - create a president variable taking values gop and dem, remove
    prez\_dem, prez\_gop & the day variable.

#### 2\_1 Read and Tidy dataset: Pols

``` r
# read in pols-month.csv
pols = 
  read_csv("./data/pols-month.csv", col_names = TRUE)%>% 
  janitor::clean_names() 
```

    ## Parsed with column specification:
    ## cols(
    ##   mon = col_date(format = ""),
    ##   prez_gop = col_double(),
    ##   gov_gop = col_double(),
    ##   sen_gop = col_double(),
    ##   rep_gop = col_double(),
    ##   prez_dem = col_double(),
    ##   gov_dem = col_double(),
    ##   sen_dem = col_double(),
    ##   rep_dem = col_double()
    ## )

``` r
# tidy dataset pols
pols_tidy = 
  mutate (pols,
    # change date format
    date = as.Date(mon, format='%m/%d/%Y')
  ) %>% 
  # break date to three vars
  separate(., "date", c("year", "month", "day")) %>% 
  mutate(
  month = as.numeric(month),
  #replace month number with month name
  month = month.name[c(month)],
  year = as.integer(year)
  ) %>% 
  # create a president var taking values from prez_gop and prez_gop
  mutate(., president = ifelse (prez_gop == 1, "gop", "dem")) %>%  
  # reorder varaibles and remove three variables
  select(year, month, everything(), -prez_dem, -prez_gop, -day)

head(pols_tidy, 5)
```

    ## # A tibble: 5 x 10
    ##    year month mon        gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##   <int> <chr> <date>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ## 1  1947 Janu… 1947-01-15      23      51     253      23      45     198
    ## 2  1947 Febr… 1947-02-15      23      51     253      23      45     198
    ## 3  1947 March 1947-03-15      23      51     253      23      45     198
    ## 4  1947 April 1947-04-15      23      51     253      23      45     198
    ## 5  1947 May   1947-05-15      23      51     253      23      45     198
    ## # … with 1 more variable: president <chr>

#### 2\_2 2\_1 Read and Tidy dataset: snp

``` r
# read and tidy in snp.csv
snp_tidy = 
  read_csv("./data/snp.csv", col_names = TRUE) %>% 
  mutate (
    # change date format
    Date1 = as.Date(date, format='%m/%d/%Y')
  ) %>% 
  janitor::clean_names() %>% 
  # break date to three vars
  separate(., "date1", c("year", "month", "day")) %>% 
  mutate (
   month = as.numeric(month),
   #replace month number with month name
   month = month.name[c(month)],
   year = as.integer(year)
  ) %>% 
  # reorder varaibles and remove three variables
  select(year, month, everything(), -day)
```

    ## Parsed with column specification:
    ## cols(
    ##   date = col_character(),
    ##   close = col_double()
    ## )

``` r
# arrange snp_tidy by year and month
snp_tidy = arrange(snp_tidy, year, month)

head(snp_tidy, 5)
```

    ## # A tibble: 5 x 4
    ##    year month    date      close
    ##   <int> <chr>    <chr>     <dbl>
    ## 1  1950 April    4/3/1950   18.0
    ## 2  1950 August   8/1/1950   18.4
    ## 3  1950 December 12/1/1950  20.4
    ## 4  1950 February 2/1/1950   17.2
    ## 5  1950 January  1/3/1950   17.0

#### 2\_3 2\_1 Read and Tidy dataset: unemployment

``` r
# read in unemployment.csv
unemployment = 
  read_csv("./data/unemployment.csv", col_names = TRUE) %>% 
  janitor::clean_names()
```

    ## Parsed with column specification:
    ## cols(
    ##   Year = col_double(),
    ##   Jan = col_double(),
    ##   Feb = col_double(),
    ##   Mar = col_double(),
    ##   Apr = col_double(),
    ##   May = col_double(),
    ##   Jun = col_double(),
    ##   Jul = col_double(),
    ##   Aug = col_double(),
    ##   Sep = col_double(),
    ##   Oct = col_double(),
    ##   Nov = col_double(),
    ##   Dec = col_double()
    ## )

``` r
# tidy dataset employment 
unemployment_tidy = 
  pivot_longer(
    unemployment,
    jan:dec,
    names_to = "month",
    values_to = "unemploy_rate"
  ) %>% 
  mutate(
   year = as.integer(year) 
  ) %>% 
  select(year, month, everything())

head(unemployment_tidy, 5)
```

    ## # A tibble: 5 x 3
    ##    year month unemploy_rate
    ##   <int> <chr>         <dbl>
    ## 1  1948 jan             3.4
    ## 2  1948 feb             3.8
    ## 3  1948 mar             4  
    ## 4  1948 apr             3.9
    ## 5  1948 may             3.5

#### 2\_4 Join datasets snp, pols and unemployment

``` r
# joining snp_tidy to pols_tidy by year and month
pols_snp = 
  left_join(pols_tidy, snp_tidy, by = c('year' = 'year', 'month' = 'month')) %>% 
  select(year, month, close, president,everything())

# check joined dataset
head(pols_snp,5)
```

    ## # A tibble: 5 x 12
    ##    year month close president mon        gov_gop sen_gop rep_gop gov_dem
    ##   <int> <chr> <dbl> <chr>     <date>       <dbl>   <dbl>   <dbl>   <dbl>
    ## 1  1947 Janu…    NA dem       1947-01-15      23      51     253      23
    ## 2  1947 Febr…    NA dem       1947-02-15      23      51     253      23
    ## 3  1947 March    NA dem       1947-03-15      23      51     253      23
    ## 4  1947 April    NA dem       1947-04-15      23      51     253      23
    ## 5  1947 May      NA dem       1947-05-15      23      51     253      23
    ## # … with 3 more variables: sen_dem <dbl>, rep_dem <dbl>, date <chr>

``` r
tail(pols_snp,5)
```

    ## # A tibble: 5 x 12
    ##    year month close president mon        gov_gop sen_gop rep_gop gov_dem
    ##   <int> <chr> <dbl> <chr>     <date>       <dbl>   <dbl>   <dbl>   <dbl>
    ## 1  2015 Febr… 2104. dem       2015-02-15      31      54     245      18
    ## 2  2015 March 2068. dem       2015-03-15      31      54     245      18
    ## 3  2015 April 2086. dem       2015-04-15      31      54     244      18
    ## 4  2015 May   2107. dem       2015-05-15      31      54     245      18
    ## 5  2015 June  2063. dem       2015-06-15      31      54     246      18
    ## # … with 3 more variables: sen_dem <dbl>, rep_dem <dbl>, date <chr>

``` r
# joining unemployment_tidy to pols_snp by year and month
pols_snp_unemploy = 
  left_join(pols_snp, unemployment_tidy, by = c('year' = 'year', 'month' = 'month')) %>%
  select(year, month, unemploy_rate, close, president, everything())

# check joined dataset
head(pols_snp_unemploy,5)
```

    ## # A tibble: 5 x 13
    ##    year month unemploy_rate close president mon        gov_gop sen_gop
    ##   <int> <chr>         <dbl> <dbl> <chr>     <date>       <dbl>   <dbl>
    ## 1  1947 Janu…            NA    NA dem       1947-01-15      23      51
    ## 2  1947 Febr…            NA    NA dem       1947-02-15      23      51
    ## 3  1947 March            NA    NA dem       1947-03-15      23      51
    ## 4  1947 April            NA    NA dem       1947-04-15      23      51
    ## 5  1947 May              NA    NA dem       1947-05-15      23      51
    ## # … with 5 more variables: rep_gop <dbl>, gov_dem <dbl>, sen_dem <dbl>,
    ## #   rep_dem <dbl>, date <chr>

``` r
tail(pols_snp_unemploy,5)
```

    ## # A tibble: 5 x 13
    ##    year month unemploy_rate close president mon        gov_gop sen_gop
    ##   <int> <chr>         <dbl> <dbl> <chr>     <date>       <dbl>   <dbl>
    ## 1  2015 Febr…            NA 2104. dem       2015-02-15      31      54
    ## 2  2015 March            NA 2068. dem       2015-03-15      31      54
    ## 3  2015 April            NA 2086. dem       2015-04-15      31      54
    ## 4  2015 May              NA 2107. dem       2015-05-15      31      54
    ## 5  2015 June             NA 2063. dem       2015-06-15      31      54
    ## # … with 5 more variables: rep_gop <dbl>, gov_dem <dbl>, sen_dem <dbl>,
    ## #   rep_dem <dbl>, date <chr>
